# QT

## 引子

我们将要学习QT, 但QT到底是用来干什么的呢? 这个引子将解决这个问题.

首先, 既然我们已经学到QT了, 那应该就对互联网的核心岗位有了一定的理解:

- 开发
  对于开发来说, 简单的说, 就是程序员, 也是我们之后主要考虑的岗位
- 测试
  程序没问题才能交付给客户, 测试就是尽可能确保程序没有问题的一个岗位
- 运维
  运维主要在大厂, 他们一般负责管理服务器
- 产品经理
  产品经理其实是一个非技术岗, 他的主要职责是向开发人员描述需求, 由于他对技术可能不是很了解, 所以可能向开发人员提出一个较为离谱的需求, 因此经常与开发人员产生摩擦.

那我们QT在哪里呢? 我们QT是在开发里的, 对于开发来说, 又可以具体分为

1. 后端开发
2. 前端开发
3. 算法工程师
4. 游戏开发
5. ...

而在前端开发里, 有可以分为 1) 网页开发, 2) 桌面应用开发 3)移动程序开发, 我们的QT就在桌面开发里面, 说白了就是做电脑里的客户端. 对于客户端开发, 是前段开发的一个经典分支, 从苹果把第一个图形化界面系统退出后就正式登场了, 也就是上世纪八十年代的时候,  其它两个都是后来有的, 另外, 前端开发根据不同语境可能特指不同的分支或者大前端, 要注意区分.  

----

在上面的讨论中, 我们提到了"客户端"这个概念, "客户端"就是直接和用户打交道的这一端程序, 与之对应的就是"服务端", 有时, 仅依靠"客户端"不足以满足用户的需求, 这时候就需要"服务端"将各个客户端联系起来, 比如, 对于打车, 用户输入目的地, 生成订单, 订单发送到服务端, 服务端进行解析订单分配, 从而让用户打到车, 当然有的客户端也不用网, 或者网络属性不强, 比如Windows的画图板, 这分Markdown文档的编辑器Typora, 它们也是客户端, 所以说, 对于客户端来说, 其含义还是比较灵活的.

根据平台的不同, 客户端就有电脑桌面和移动设备的区别, QT主攻的就是电脑桌面级别的客户端开发, 尽管QT也支持进行移动开发, 但是并不是市场上的主流移动开发方案, 毕竟有现成的方案, 我为什么要改呢?

对于客户端来说, 一个很重要的任务, 就是编写和用户交互的界面, 界面有两种分隔 1) TUI, 即"Text User Interface"(文本用户界面), 就是敲命令行的, 2) GUI, 即"Graphical User Interface"(图形化用户界面).   对于TUI, 来说, 一般面向的是从事开发岗位的专业软件, 而GUI, 就是面向普通用户. QT就是编写桌面GUI程序的框架. 不过对于Windows, 也有其他的GUI程序开发方案.

TUI和GUI, 没有高低贵贱之分, 尽管我们是先学TUI, 再学GUI, 但是这是因为TUI的剩下内容都很难, 毕竟它的专业性摆在这, 比如GCC它们这类编译器, 技术含量可高了. 当然, GUI这边也有Visual Studio.

-------------

接下来我们看看Qt和它的同行们.

对于桌面GUI程序开发(注意, 默认语境是Windows系统下, 毕竟它用户基数大), 我们有一些解决方案:

首先就是Windows API了, 即调用Windows自己的系统接口, 这是一种十分古老的开发方式, 非常繁琐麻烦; 接着就是MFC, 它其实就是微软对于Win32 API的C/C++再封装, 它有很大的影响力, 怎么说吧, 和它配对的事VC 6.0, 目前国内仍有一些教学使用MFC, MFC具有划时代的意思, 它甚至可以以图形化界面的方式拖动要开发的图像化界面, 不过, 后来由于微软推出了自己的C #(C sharp), 从此微软和C/C++就渐行渐远, 基于C/C++的MFC就逐渐不给资源, 现在微软自己也放弃了MFC;  接着就是Qt了, 虽然它和MFC差不多大, 也是C/C++体系的, 但区别是依旧更新(MFC早就不更新了), 也是依旧很有生命力, 也是一种主流的桌面程序开发方案;  后来微软退出了C sharp(可不能念"#"), 于是微软就把大量资源倾斜给了自己的C sharp, 然后推出了Windows Forms(C # 和.net体系), 后来微软又推出了Forms的升级版, WPF以及更后来的UWP, UWP和它的前辈相比, (可能)具有跨平台能力, 目前微软希望这项技术成为市场主流, 不过前景不明. 

近些年来, 还有一个叫"Electron"的技术, "Electron"的技术路线可以说比较不同, 简单的来说, 它内部其实是个浏览器内核, 主要是Chromium, 由于是浏览器, 所以就可以直接使用网页开发的技术, 直接编写HTML/CSS/JS就行了, 优点就是技术路线统一, 开发成本低, 只要内核能跨平台, 网页就自然能跨平台, 很省事. 更新程序换网页就行, 缺点就是和底层调用API的前辈相比, 效率低了一些, 并且由于各个软件都自带浏览器内核, 所以软件大, 运行起来用户体验不是很好, 有原始技术积累的大厂比较喜欢用这套方案.

"Electron"最初是Github官方为开发"atom"文本编辑器而开创的, "atom"的对手就是"Visual Studio Code". 吗结果可想而知, "atom"死了, 不过一方面,  "Visual Studio Code"其实用的也是"Electron", 再加上后来Github被微软收购, 所以现在""Electron""也跟微软姓了.

对于Qt来说, 仍然是很优秀的. 尽管Qt没有UWP那种级别的跨平台(UWP是移动设备也可以用<存疑, 反正微软是这么讲的>), 但无论是Windows, 亦或者Linux, MacOS, 都是支持的. 效率比"Electron高, 在公认层面上的跨平台能力比Windows系列强.

## 背景

Qt的官方描述是一个跨平台的C++图形化界面应用程序框架. 这里提到了一个我们C++学习阶段并不常见的词--框架.   框架是什么? 如果我们之前学过Java, 那可能对框架有较深的认识, 简单地来说, 框架就是程序员中的佼佼者发明出来的, 可以帮助我们这些普通的菜鸡程序员, 可以写出来更靠谱的代码. 对于语言来说, 自由与灵活既是优点也是缺点, 优点就是因为自由, 你可以尽情发挥你的水平, 缺点是对于没有水平的, 乱写容易出错. 框架就能固定程序的大致结构, 可以确保程序开发的下限, 程序主体已经被框架固定了, 我们只需要在这套框架下, 在一些关键细节进行微操, 从而实现具体的功能. 与框架相比, 库也是大佬写的, 但库是被动的, 程序员决定何时使用库, 又怎么用, 框架则是主动的, 程序员配合框架完善细节.

谈到这里, 我们可以杂谈一下C++和Java的生态状况, 形象地来说, C++的生态环境是松散联邦, 军阀割据? 它的生态是割裂离散的, 而Java就是中央集权, 有一些影响力在语言里找不到对手的那种大社区, 比如Spring虽然不在Java标准中, 但实际上已经是公认标准了, C++一方面标准委员会主观性不太强, 另一方面, 由于中央政府集权不行, 所以大家都各自搞各自的框架, 谁也不服谁, 像Qt这种, 在C++内公认的框架, 可以说是十分少见的, 也是近似标准的存在.

Qt, 最开始, 在1991年由挪威的公司 Trolltech 开发, 该公司的具体信息不明, 值得一题的是, 1991年被称为计算机奇迹年, 包括Qt, Python, Vim, OpenGL, Linux..它们都诞生在1991年. 在1996年, Qt进入商业领域, 参与了Linux桌面环境系统KDE的开发, 时至今日, KDE仍旧是Linux最主流的桌面环境之一, KDE的著名也使得Qt在Linux界享有盛名; 2008年, Trolltech 公司被当时的手机巨头Nokia, 即诺基亚收购, 并被诺基亚视为自己旗下的主打技术, 参与对Nokia的塞班手机系统应用程序的主流解决方案. 但随着乔布斯在2007年发布iPhone 1, 宣告移动互联网时代的到来, 诺基亚的手机业务不断被压缩, 最终2011年, Nokia将Qt卖给了芬兰公司 Digia, 并在2016年从Digia中独立出来, 变成了Qt Group Plc，总部在芬兰赫尔辛基, 现在, Qt Group 既负责 Qt 的开发，也提供商业授权和支持。Qt 本身依旧是 LGPL/GPL 开源 + 商业授权 双模式。

接下来看Qt所支持的平台, Qt支持很多平台, 这也正是Qt的优点之一, 按照大类来分, 有四种:

- Windows系列
  Windows是Qt的主场之一, 也是我们之后求职时的一个主要方向之一
- Linux各种发行版, 特别是KDE桌面
  尽管Linux现在主要都是在服务器上运行的, 作为服务器系统来说, Linux其实并不需要图形化界面--图形化反而会影响Linux的服务效率. 但仍存在一些群体, 将Linux装载并作为个人电脑上使用, 在加上Linux在开发者心中具有的特殊地位, Linux仍就演化出了桌面环境及图形化界面. 不过与Windows不同的是, 毕竟最开始桌面环境并不在Linux的设计需求中, 所以Linux并不像Windows那样, 桌面是嵌入到内核中的, 所以桌面环境就是Windows桌面,  而对于Linux来说, 它目前有两条主流的桌面环境, 1) GNOME(使用GTK构建) 2) KDE(使用Qt构建). 与Window相比, Linux的桌面自由度要远比Windows高, 只要你会, 而且能折腾, 那就可以自由配置, 配置成你心中最美的桌面, 但不可否认的是, Linux确实不适合作为个人电脑使用, 个人使用Linux通常意味着可能要与时不时的桌面崩溃, 更新系统驱动异常, 休眠后无法唤醒等玄妙问题和平共处
- Mac 系统
  不甚了解, 还没在Mac平台上开发过, 听说Mac的开发体验很好, 但也有人认为是品牌夸大效应. 只能说我没用过, 还没发言权.
- 嵌入式系统
  这是Qt的另一个主场. 有时, 我们仅需要电脑满足一些基础功能, 比如各种智能家电的控制系统, 工业设备的操作系统, 这种设备不需要太强的硬件性能, 够用就行了, 但对于这些设备来说, 也可能需要一些图形化界面程序, 这对于工业自动化设备尤其常见, 但因为硬件性能的限制, 你不太好往里面装个完整的操作系统 , 所以就需要开发能在弱操作系统甚至无操作系统的机器上运行的图形化界面, Qt就能满足这一点. 不过近年来, 随着硬件的发展, 在这些机器上装一个安卓倒也可以, 然后用安卓的开发方式开发图形化界面程序. 不过Qt仍旧是主流的嵌入式环境图形化界面程序的开发方案. 这也是我们的一个主流就业方向.

Qt 目前已经推出了第六代版本，也就是 **Qt 6**。不过整体来看，Qt 5 和 Qt 6 并没有本质上的差别，再加上企业里依然有大量项目基于 Qt 5，所以我们后续的学习也会以 **Qt 5** 为主。要知道，在商业软件开发中，并不是版本越新越好，关键是要保证产品的稳定可靠。一个版本如果经过了时间的考验，证明足够稳定，那它才适合在生产环境中使用。相比之下，最新版本虽然可能带来新特性，但也可能潜藏着未知的 Bug，因此实际开发的原则是：**选择稳定的较新版本，而不是追逐最新版本**。

另外, Qt在发布时还提供了两种许可证:

- 商业许可: 允许开发者出于商业目的使用 Qt 框架进行开发和发布。商业许可用户不仅能使用更多功能，还能在遇到难以解决的问题时，直接获得 Qt Group Plc 的技术支持。
- 开源许可: 开源项目依据相关开源协议, 直接使用开源的Qt框架

这种 **“开源 + 商业授权”** 的模式在软件开发界很常见。开源能扩大用户群体，提升影响力和市场占有率；商业授权则为用户提供技术支持和保障，带来的收益又能反哺技术发展。典型的例子就是 Linux 的 Red Hat，或者数据库领域的 Oracle。虽然它们收费，但依然有很多企业愿意买单，因为买的不只是软件，而是一份“定心丸”。

对于Qt的优点, 有以下几个方面:

- 跨平台, 几乎支持所有平台.
- 接口简单, 容易上手, 同时作为一种知名框架, 它里面的思想对其他框架的学习也有指导意义
- 它对C++的梦魇, 内存泄露进行了优化, 提供了一种方式, 简化C++内存回收机制, 既没有过分拉低C++的高效率特点, 也带来一种近似半自动垃圾回收方案
- 开发效率高, 能够快速构建应用程序
- 市场占有率高, 用户基数大, 有很活跃的社区环境, 网络上也有很多学习资料
- 支持嵌入式开发, 在嵌入式图形界面开发中依然是主流方案之一。

